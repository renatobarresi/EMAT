/*
 * filesystem.cpp
 *
 *  Created on: May 19, 2023
 *      Author: renatobarresi
 */

#include "filesystem.h"

/* Constructor */
fileSystem::fileSystem()
{
	flash_init();
	int res = lfs_mount(&lfs, &cfg);
    if (res < 0)
    {
        // If the mount fails, try formatting the filesystem
        res = lfs_format(&lfs, &cfg);
        if (res < 0) {
        	while(1);
        }
        // Try mounting again
        res = lfs_mount(&lfs, &cfg);
        if (res < 0) {
        	errorHandler(__FILE__, __LINE__, ERROR_FATAL, "unable to mount filesystem");
        }
    }

}

/* Public methods */
fileSystem& fileSystem::getInstance()
{
	static fileSystem instance;
	return instance;
}

uint8_t fileSystem::open()
{
	return 1;
}
uint8_t fileSystem::write()
{
	return 1;
}
uint8_t fileSystem::read()
{
	return 1;
}
